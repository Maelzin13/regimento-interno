"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[267],{267:(k,m,s)=>{s.r(m),s.d(m,{LoginPageModule:()=>C});var p=s(177),d=s(4341),r=s(3092),u=s(6755),g=s(467);var e=s(4438),f=s(8440);const y=[{path:"",component:(()=>{var a;class l{constructor(n,o,i,t){this.router=n,this.authService=o,this.toastController=i,this.loadingController=t,this.email="",this.password=""}ngOnInit(){var n=this;return(0,g.A)(function*(){const o=yield n.presentLoading("Verificando sess\xe3o...");n.authService.handleRedirectCallback();try{if(n.nameApp="Regimento Interno Comentado",n.authService.getAuthToken()){const t=yield n.authService.fetchProfile();localStorage.setItem("authUser",JSON.stringify(t)),n.authService.userChanged.next(t),yield o.dismiss(),n.router.navigate(["/home"])}else yield o.dismiss()}catch(i){yield o.dismiss(),n.presentToast("Erro ao buscar sess\xe3o: "+i.message)}})()}login(){var n=this;return(0,g.A)(function*(){const o=yield n.presentLoading("Entrando...");try{const i=yield n.authService.login(n.email,n.password);n.authService.saveAuthToken(i);const t=yield n.authService.fetchProfile();localStorage.setItem("authUser",JSON.stringify(t)),n.authService.userChanged.next(t),yield o.dismiss(),n.email="",n.password="",n.router.navigate(["/home"])}catch(i){yield o.dismiss(),n.presentToast(i.message)}})()}socialLogin(n){var o=this;return(0,g.A)(function*(){const i=yield o.presentLoading(`Conectando com ${"google"===n?"Google":"Facebook"}...`);try{const t="google"===n?yield o.authService.googleLogin():yield o.authService.facebookLogin();if(null==t||!t.user||null==t||!t.token)throw new Error(`Login com ${n} falhou.`);o.authService.saveAuthToken(t.token),localStorage.setItem("authUser",JSON.stringify(t.user)),o.authService.userChanged.next(t.user),yield i.dismiss(),o.router.navigate(["/home"])}catch(t){yield i.dismiss(),o.presentToast(t.message||`Erro ao conectar com ${n}`)}})()}presentLoading(n="Carregando..."){var o=this;return(0,g.A)(function*(){const i=yield o.loadingController.create({message:n,spinner:"bubbles",translucent:!0,backdropDismiss:!1});return yield i.present(),i})()}presentToast(n){var o=this;return(0,g.A)(function*(){(yield o.toastController.create({message:n,duration:3e3,color:"danger",position:"middle"})).present()})()}}return(a=l).\u0275fac=function(n){return new(n||a)(e.rXU(u.Ix),e.rXU(f.u),e.rXU(r.K_),e.rXU(r.Xi))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-login"]],decls:31,vars:3,consts:[[1,"ion-no-border","transparent"],["id","toolbar"],[1,"header-title",2,"text-align","center"],["fullscreen","true","scroll-y","true",1,"login-content"],[1,"center-container"],[1,"login-card"],["lines","inset"],["name","mail-outline","slot","start"],["type","email","placeholder","Email","label","Email","label-placement","floating","autocomplete","on",3,"ngModelChange","ngModel"],["lines","inset",1,"ion-margin-top"],["name","lock-closed-outline","slot","start"],["type","password","placeholder","Senha","label","Senha","label-placement","floating",3,"ngModelChange","ngModel"],["expand","block",1,"login-btn","ion-margin-top",3,"click"],[1,"separator"],[1,"line"],[1,"separator-text"],[1,"ion-justify-content-center"],["size","12",1,"ion-margin-bottom"],["expand","block",1,"social-btn","google-btn",3,"click"],["slot","start","name","logo-google"],["size","12"],["expand","block",1,"social-btn","facebook-btn",3,"click"],["slot","start","name","logo-facebook"]],template:function(n,o){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title",2),e.EFF(3),e.k0s()()(),e.j41(4,"ion-content",3)(5,"div",4)(6,"ion-card",5)(7,"ion-card-content")(8,"ion-item",6),e.nrm(9,"ion-icon",7),e.j41(10,"ion-input",8),e.mxI("ngModelChange",function(t){return e.DH7(o.email,t)||(o.email=t),t}),e.k0s()(),e.j41(11,"ion-item",9),e.nrm(12,"ion-icon",10),e.j41(13,"ion-input",11),e.mxI("ngModelChange",function(t){return e.DH7(o.password,t)||(o.password=t),t}),e.k0s()(),e.j41(14,"ion-button",12),e.bIt("click",function(){return o.login()}),e.EFF(15," Entrar "),e.k0s(),e.j41(16,"div",13),e.nrm(17,"div",14),e.j41(18,"span",15),e.EFF(19,"Ou entre com"),e.k0s(),e.nrm(20,"div",14),e.k0s(),e.j41(21,"ion-grid")(22,"ion-row",16)(23,"ion-col",17)(24,"ion-button",18),e.bIt("click",function(){return o.socialLogin("google")}),e.nrm(25,"ion-icon",19),e.EFF(26," Google "),e.k0s()(),e.j41(27,"ion-col",20)(28,"ion-button",21),e.bIt("click",function(){return o.socialLogin("facebook")}),e.nrm(29,"ion-icon",22),e.EFF(30," Facebook "),e.k0s()()()()()()()()),2&n&&(e.R7$(3),e.JRh(o.nameApp),e.R7$(7),e.R50("ngModel",o.email),e.R7$(3),e.R50("ngModel",o.password))},dependencies:[d.BC,d.vS,r.Jm,r.b_,r.I9,r.hU,r.W9,r.lO,r.eU,r.iq,r.$w,r.uz,r.ln,r.BC,r.ai,r.Gw],styles:[".transparent-header[_ngcontent-%COMP%]{--background: transparent}.transparent-header[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{text-align:center;font-weight:700;font-size:1.6rem}.scrollable-content[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;justify-content:center;padding:2rem 1rem}.login-content[_ngcontent-%COMP%]{--background: linear-gradient(to bottom right, #f5f7fa, #c3cfe2)}.center-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:2rem 1rem;height:100%}.login-card[_ngcontent-%COMP%]{width:100%;max-width:400px;border-radius:15px;padding:20px;box-shadow:0 4px 20px #0000001a}.separator[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin:1.5rem 0}.separator[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{flex:1;height:1px;background-color:#ccc;margin:0 10px}.separator[_ngcontent-%COMP%]   .separator-text[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.login-card[_ngcontent-%COMP%]{max-width:400px;margin:0 auto}@media (max-width: 320px){.login-card[_ngcontent-%COMP%]{padding:10px}}"]}),l})()}];let b=(()=>{var a;class l{}return(a=l).\u0275fac=function(n){return new(n||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[u.iI.forChild(y),u.iI]}),l})(),C=(()=>{var a;class l{}return(a=l).\u0275fac=function(n){return new(n||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[p.MD,d.YN,r.bv,b]}),l})()}}]);