"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5647],{5647:(J,b,l)=>{l.r(b),l.d(b,{ViewTextPageModule:()=>q});var d=l(177),p=l(4341),a=l(3092),u=l(6755),f=l(467),w=l(4389),P=l(54),y=l(7817),n=l(4438),G=l(5267),C=l(8440),R=l(345);function F(e,r){if(1&e&&(n.qex(0),n.j41(1,"p",18)(2,"span",19),n.EFF(3),n.nI1(4,"titlecase"),n.k0s(),n.nrm(5,"br")(6,"span",17),n.k0s(),n.bVm()),2&e){const o=r.$implicit,t=n.XpG(8);n.R7$(3),n.JRh(n.bMT(4,2,o.tipo)),n.R7$(3),n.Y8G("innerHTML",t.safeHTML(o.conteudo),n.npT)}}function I(e,r){if(1&e&&(n.qex(0),n.nrm(1,"h5",17),n.DNE(2,F,7,4,"ng-container",13),n.bVm()),2&e){const o=r.$implicit,t=n.XpG(7);n.R7$(),n.Y8G("innerHTML",t.safeHTML(o.conteudo),n.npT),n.R7$(),n.Y8G("ngForOf",o.comentarios)}}function L(e,r){if(1&e&&(n.qex(0),n.nrm(1,"h5",17),n.DNE(2,I,3,2,"ng-container",13),n.bVm()),2&e){const o=r.$implicit,t=n.XpG(6);n.R7$(),n.Y8G("innerHTML",t.safeHTML(o.conteudo),n.npT),n.R7$(),n.Y8G("ngForOf",o.paragrafos)}}function B(e,r){if(1&e&&(n.qex(0),n.nrm(1,"h4",16),n.DNE(2,L,3,2,"ng-container",13),n.bVm()),2&e){const o=r.$implicit,t=n.XpG(5);n.R7$(),n.Y8G("innerHTML",t.safeHTML(o.conteudo),n.npT),n.R7$(),n.Y8G("ngForOf",o.artigos)}}function $(e,r){if(1&e&&(n.qex(0),n.nrm(1,"h3",15),n.DNE(2,B,3,2,"ng-container",13),n.bVm()),2&e){const o=r.$implicit,t=n.XpG(4);n.R7$(),n.Y8G("innerHTML",t.safeHTML(o.conteudo),n.npT),n.R7$(),n.Y8G("ngForOf",o.secaos)}}function N(e,r){if(1&e&&(n.qex(0),n.nrm(1,"h2",14),n.DNE(2,$,3,2,"ng-container",13),n.bVm()),2&e){const o=r.$implicit,t=n.XpG(3);n.R7$(),n.Y8G("innerHTML",t.safeHTML(o.conteudo),n.npT),n.R7$(),n.Y8G("ngForOf",o.capitulos)}}function j(e,r){if(1&e&&(n.qex(0),n.DNE(1,N,3,2,"ng-container",13),n.bVm()),2&e){const o=n.XpG(2);n.R7$(),n.Y8G("ngForOf",(o.filteredBook||o.book).titulos)}}function E(e,r){if(1&e&&(n.qex(0),n.DNE(1,j,2,1,"ng-container",12),n.bVm()),2&e){const o=n.XpG(),t=n.sdS(19);n.R7$(),n.Y8G("ngIf",null==(o.filteredBook||o.book)||null==(o.filteredBook||o.book).titulos?null:(o.filteredBook||o.book).titulos.length)("ngIfElse",t)}}function H(e,r){if(1&e){const o=n.RV6();n.qex(0),n.j41(1,"ion-item")(2,"ion-label"),n.nrm(3,"h3",15),n.k0s(),n.j41(4,"ion-icon",24),n.bIt("click",function(){const i=n.eBV(o).$implicit,c=n.XpG(4);return n.Njj(c.navigateToCapitulo(i))}),n.k0s()(),n.bVm()}if(2&e){const o=r.$implicit,t=n.XpG(4);n.R7$(3),n.Y8G("innerHTML",t.safeHTML(o.conteudo),n.npT)}}function O(e,r){if(1&e&&(n.j41(0,"ion-card",21)(1,"ion-card-header")(2,"ion-card-title",22),n.EFF(3),n.k0s()(),n.j41(4,"ion-card-content")(5,"ion-list",23),n.DNE(6,H,5,1,"ng-container",13),n.k0s()()()),2&e){const o=r.$implicit,t=n.XpG(3);n.R7$(3),n.JRh(t.cleanHTML(o.conteudo)),n.R7$(3),n.Y8G("ngForOf",o.capitulos)}}function S(e,r){if(1&e&&(n.j41(0,"div"),n.DNE(1,O,7,2,"ion-card",20),n.k0s()),2&e){const o=n.XpG(2);n.R7$(),n.Y8G("ngForOf",(o.filteredBook||o.book).titulos)}}function X(e,r){if(1&e&&(n.qex(0),n.DNE(1,S,2,1,"div",11),n.bVm()),2&e){const o=n.XpG();n.R7$(),n.Y8G("ngIf",null==(o.filteredBook||o.book)||null==(o.filteredBook||o.book).titulos?null:(o.filteredBook||o.book).titulos.length)}}function Y(e,r){1&e&&(n.j41(0,"div",25),n.nrm(1,"ion-spinner"),n.j41(2,"p",26),n.EFF(3,"Carregando dados..."),n.k0s()())}function D(e,r){if(1&e){const o=n.RV6();n.j41(0,"ion-footer")(1,"ion-toolbar")(2,"ion-buttons",27)(3,"ion-button",28),n.bIt("click",function(){n.eBV(o);const i=n.XpG();return n.Njj(i.scrollToTop())}),n.EFF(4,"Voltar pro topo"),n.k0s()()()()}}const A=[{path:"",component:(()=>{var e;class r{constructor(t,i,c,g,s,_){this.router=t,this.route=i,this.bookService=c,this.authService=g,this.sanitizer=s,this.modalController=_,this.query="",this.filteredBook=null,this.selectedSegment="corrido",this.notaListenerAttached=!1,this.user=null,this.searchBy="keyword"}ngOnInit(){const t=this.authService.getUser();this.user=t,this.bookId=this.route.snapshot.paramMap.get("id"),this.bookService.getBookById(this.bookId).then(i=>{this.book=i.livro}).catch(i=>{console.error("Erro ao carregar os livros:",i)})}onSearchInput(t){this.query=t.target.value,this.search()}search(){if(!this.query||!this.book)return void(this.filteredBook=null);const t=this.query.toLowerCase(),i=this.searchBy,c=JSON.parse(JSON.stringify(this.book));c.titulos=c.titulos.map(g=>{const s=g.capitulos.map(_=>{const M=_.secaos.map(V=>{const k=V.artigos.filter(m=>{var h,T,x;return"keyword"===i?(null===(h=m.conteudo)||void 0===h?void 0:h.toLowerCase().includes(t))||(null===(T=m.paragrafos)||void 0===T?void 0:T.some(z=>{var v;return null===(v=z.conteudo)||void 0===v?void 0:v.toLowerCase().includes(t)})):"artigo"===i&&(null===(x=m.conteudo)||void 0===x?void 0:x.toLowerCase().includes(`art. ${t}`))});return k.length?{...V,artigos:k}:null}).filter(Boolean);return M.length?{..._,secaos:M}:null}).filter(Boolean);return s.length?{...g,capitulos:s}:null}).filter(Boolean),this.filteredBook=c}navigateToCapitulo(t){this.router.navigate(["/chapters",t.id],{state:{capitulo:t}})}ngAfterViewInit(){this.notaListenerAttached||(this.listenNotaClicks(),this.notaListenerAttached=!0)}listenNotaClicks(){var t=this;document.addEventListener("click",function(){var i=(0,f.A)(function*(c){const g=c.target;if(g.classList.contains("nota-ref")){const s=g.getAttribute("data-nota-id");if(s){const _=yield t.bookService.getNotesById(s);console.log("Nota:",_),t.openModalWithContent(_.conteudo)}}});return function(c){return i.apply(this,arguments)}}())}formatNotas(t){return t.replace(/###nota (\d+)###/g,(c,g)=>`\n        <div \n          class="nota-ref-container" \n          style="display: inline-block; vertical-align: baseline; margin-left: 3px; margin-top: 6px;"\n        >\n          <sup \n        class="nota-ref" \n        data-nota-id="${g}" \n        role="link" \n        tabindex="0"\n        style="\n          color: #007bff;\n          cursor: pointer;\n          font-size: 0.75em;\n          user-select: none;\n          text-decoration: underline;\n        "\n          >\n        ${g}\n          </sup>\n        </div>`)}openModalWithContent(t){var i=this;return(0,f.A)(function*(){return yield(yield i.modalController.create({component:P.y,componentProps:{content:t}})).present()})()}safeHTML(t){const i=this.formatNotas(t);return this.sanitizer.bypassSecurityTrustHtml(i)}cleanHTML(t){return(new DOMParser).parseFromString(t,"text/html").body.textContent||""}showModal(t){var i=this;return(0,f.A)(function*(){return yield(yield i.modalController.create({component:w.V,componentProps:{content:t}})).present()})()}abrirEditor(t,i){var c=this;return(0,f.A)(function*(){return yield(yield c.modalController.create({component:y.o,componentProps:{itemId:t,itemType:i}})).present()})()}scrollToTop(){this.content.scrollToTop(500)}}return(e=r).\u0275fac=function(t){return new(t||e)(n.rXU(u.Ix),n.rXU(u.nX),n.rXU(G.l),n.rXU(C.u),n.rXU(R.up),n.rXU(a.W3))},e.\u0275cmp=n.VBU({type:e,selectors:[["app-view-text"]],viewQuery:function(t,i){if(1&t&&n.GBs(a.W9,5),2&t){let c;n.mGM(c=n.lsd())&&(i.content=c.first)}},decls:21,vars:6,consts:[["loading",""],["id","toolbar"],["slot","start"],["routerLink","/home"],["name","arrow-back","color","light"],["fullscreen","",1,"ion-padding"],[3,"ngModelChange","ngModel"],["value","corrido"],[1,"law-text"],["value","formatado"],["color","light","animated","true","placeholder","Buscar por palavra ou artigo...","show-clear-button","always","clear-icon","trash-bin","debounce","300",3,"ngModelChange","ionInput","ngModel"],[4,"ngIf"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[1,"titulo",3,"innerHTML"],[1,"capitulo",3,"innerHTML"],[1,"secao",3,"innerHTML"],[3,"innerHTML"],[1,"comentario"],[1,"comentario-tipo"],["class","ion-text-center",4,"ngFor","ngForOf"],[1,"ion-text-center"],[1,"titulo"],["lines","none"],["slot","end","name","chevron-forward-outline",3,"click"],[1,"ion-text-center","ion-margin-top"],[1,"text-center"],["slot","end"],[3,"click"]],template:function(t,i){if(1&t){const c=n.RV6();n.j41(0,"ion-header")(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),n.nrm(4,"ion-icon",4),n.k0s()(),n.j41(5,"ion-title"),n.EFF(6),n.k0s()()(),n.j41(7,"ion-content",5)(8,"ion-segment",6),n.mxI("ngModelChange",function(s){return n.eBV(c),n.DH7(i.selectedSegment,s)||(i.selectedSegment=s),n.Njj(s)}),n.j41(9,"ion-segment-button",7)(10,"ion-label",8),n.EFF(11,"Texto Corrido"),n.k0s()(),n.j41(12,"ion-segment-button",9)(13,"ion-label",8),n.EFF(14,"Texto Formatado"),n.k0s()()(),n.j41(15,"ion-searchbar",10),n.mxI("ngModelChange",function(s){return n.eBV(c),n.DH7(i.query,s)||(i.query=s),n.Njj(s)}),n.bIt("ionInput",function(s){return n.eBV(c),n.Njj(i.onSearchInput(s))}),n.k0s(),n.DNE(16,E,2,2,"ng-container",11)(17,X,2,1,"ng-container",11)(18,Y,4,0,"ng-template",null,0,n.C5r),n.k0s(),n.DNE(20,D,5,0,"ion-footer",11)}2&t&&(n.R7$(6),n.JRh((null==i.book?null:i.book.conteudo)||"Carregando..."),n.R7$(2),n.R50("ngModel",i.selectedSegment),n.R7$(7),n.R50("ngModel",i.query),n.R7$(),n.Y8G("ngIf","corrido"===i.selectedSegment),n.R7$(),n.Y8G("ngIf","formatado"===i.selectedSegment),n.R7$(3),n.Y8G("ngIf","formatado"!==i.selectedSegment))},dependencies:[d.Sq,d.bT,p.BC,p.vS,a.Jm,a.QW,a.b_,a.I9,a.ME,a.tN,a.W9,a.M0,a.eU,a.iq,a.uz,a.he,a.nf,a.S1,a.Gp,a.eP,a.w2,a.BC,a.ai,a.Je,a.Gw,a.N7,u.Wk,d.PV],styles:[".law-text[_ngcontent-%COMP%]{color:#000}.comment-text[_ngcontent-%COMP%]{color:green;cursor:pointer}ion-content[_ngcontent-%COMP%]{padding-top:env(safe-area-inset-top);padding-bottom:env(safe-area-inset-bottom)}.titulo[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700}.capitulo[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:500}.secao[_ngcontent-%COMP%]{font-size:1rem;font-style:italic}.comentario[_ngcontent-%COMP%]{background-color:#f1f1f1;padding:10px;border-left:4px solid var(--comentario-color);margin-bottom:12px;border-radius:5px}.comentario-tipo[_ngcontent-%COMP%]{font-weight:700;color:var(--comentario-color)}"]}),r})()}];let U=(()=>{var e;class r{}return(e=r).\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.$C({type:e}),e.\u0275inj=n.G2t({imports:[u.iI.forChild(A),u.iI]}),r})(),q=(()=>{var e;class r{}return(e=r).\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.$C({type:e}),e.\u0275inj=n.G2t({imports:[d.MD,p.YN,a.bv,U]}),r})()}}]);